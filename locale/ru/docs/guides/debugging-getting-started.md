---
название: отладка - начало работы
макет: docs.ОБДХ
---

# Руководство По Отладке

Это руководство поможет вам начать отладку узла.js приложения и скрипты.

## Включить Инспектор

При запуске с** --inspect * * переключатель, узел.процесс JS слушает через WebSockets
для диагностических команд, определенных протоколом [Inspector][],
по умолчанию в узле и Порту 127.0.0.1: 9229. Каждому процессу также присваивается
уникальный идентификатор UUID][] (например, `0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e`).

Клиенты инспектора должны знать и указывать адрес хоста, порт и UUID для подключения
к интерфейсу WebSocket. Полный URL-адрес
`с WS://127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e, конечно зависит
на фактическом Хосте и Порту и с правильным UUID для экземпляра.

Инспектор также включает конечную точку HTTP для обслуживания метаданных об отлаживаемом объекте,
включая URL-адрес WebSocket, UUID и URL-адрес Chrome DevTools. Получить эти метаданные
отправив HTTP-запрос в ' http://[host: port] / json / list`.  Это возвращает
JSON-объект, как в следующем; использовать webSocketDebuggerUrl` собственность как
URL для подключения непосредственно к инспектору.

<!-- eslint-skip -->
```яваскрипт
{
  "описание": "узел.экземпляр js",
  "devtoolsFrontendUrl": "хром инструменты разработчика://инструменты разработчика/комплекте/инспектор.HTML-код?эксперименты=истина&v8only=истина и WS=127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e",
  "faviconUrl": "https://nodejs.org/static/favicon.ico",
  "идентификатор": "0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e",
  "название": "узел",
  "тип": "узел",
  "адрес": "файл://",
  "webSocketDebuggerUrl": "с WS://127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e"
}
``

узел.процесс JS начала *без* `--проверить можно также поручил начать
прослушивание отладочных сообщений с помощью сигнализации SIGUSR1 (в Linux и
OS X). С узла 7 это активирует устаревший API отладчика; в узле 8 и позже
он активирует API инспектора.

---
## последствия для безопасности

Так как отладчик имеет полный доступ к узлу.среда выполнения js, a
злоумышленник, способный подключиться к этому порту, может выполнить произвольное
код от имени процесса узла. Важно понимать, безопасность
последствия предоставления порта отладчика в общедоступных и частных сетях.

### Публичный доступ к порту отладки небезопасен

Если отладчик привязан к IP-адресу, или 0.0.0.0, клиенты,
смогите достигнуть ваш IP-адрес будет соединиться к отладчику без любых
ограничение и возможность запуска произвольного кода.

По умолчанию `node --inspect ' привязывается к 127.0.0.1. Необходимо явно предоставить
общедоступный IP-адрес 0.0.0.0 и т. д., если планируется разрешить внешние подключения
к отладчику. Это может привести к потенциально значительной безопасности
угроза. Мы рекомендуем вам обеспечить соответствующие брандмауэры и средства контроля доступа
чтобы предотвратить угрозу безопасности.

См. раздел "[включение сценариев удаленной отладки] (#enabling-remote-debugging-scenaries) " о некоторых советах о том, как
чтобы благополучно разрешить клиентам удаленный отладчик для подключения.

### Локальные приложения имеют полный доступ к инспектору

Даже если вы привязываете порт инспектора к 127.0.0.1 (по умолчанию), любые приложения
запуск локально на вашем компьютере будет иметь неограниченный доступ. Это
для того, чтобы местные отладчики, чтобы иметь возможность удобно прикрепить.

### Браузеры, WebSockets и политика одинакового происхождения

Веб-сайты, открытые в web-браузере, могут делать WebSocket и HTTP запросы под
модели безопасности браузера. Для получения начального HTTP-соединения необходимо
уникальный идентификатор сеанса отладчика. Политика одинакового происхождения не позволяет веб-сайтам быть
возможность сделать это соединение HTTP. Для дополнительной безопасности против
[ДНС перепривязки атак](https://en.wikipedia.org/wiki/DNS_rebinding), узел.js
проверяет, что заголовки 'Host' для соединения либо
точно укажите IP-адрес или `localhost` или `localhost6`.

Эти политики безопасности запрещают подключение к удаленному серверу отладки
указание имени хоста. Это ограничение можно обойти, указав
либо IP-адрес или с помощью туннелей ssh, как описано ниже.

## Клиенты Инспектора

К инспектору узла можно подключить несколько коммерческих инструментов и инструментов с открытым исходным кодом. Основной
информация об этом ниже:

#### [node-inspect](https://github.com/nodejs/node-inspect)

* Отладчик CLI, поддерживаемый узлом.JS Foundation, который использует [протокол инспектора][].
* Версия поставляется с Node и может использоваться с `node inspect myscript.js.
* Последнюю версию также можно установить самостоятельно (например, `npm install-g node-inspect`)
  и используется с ' node-inspect myscript.js.

#### [Chrome DevTools](https://github.com/ChromeDevTools/devtools-frontend) 55+

* * * * Вариант 1**: Открыть " chrome: / / inspect` в хроме на основе
  броузер. Нажмите кнопку Настроить и убедитесь, что целевой хост и порт
  перечислены.
* **Вариант 2**: скопировать `devtoolsFrontendUrl` на выходе `/в JSON/список`
  (см. выше) или-проверить подсказку текст и вставить в Хром.
* * * * Опция 3**: Установите расширение Chrome NIM (Node Inspector Manager):  
  https://chrome.google.com/webstore/detail/nim-node-inspector-manage/gnhhdgbaldcilmgcpfddgdbkhjohddkj

#### [Visual Studio Code](https://github.com/microsoft/vscode) 1.10+

* На панели отладки щелкните значок параметры, чтобы открыть `.vscode / запуск.формат JSON.`
  выбранный узел.js " для начальной настройки.

#### [Visual Studio](https://github.com/Microsoft/nodejstools) 2017

* Выберите "отладка > начать отладку" в меню или нажмите F5.
* [Подробная инструкция](https://github.com/Microsoft/nodejstools/wiki/Debugging).

#### [Компании JetBrains WebStorm](https://www.jetbrains.com/webstorm/) 2017.1+ и другие компании JetBrains Эйдос

* Создайте новый узел.JS отлаживает конфигурацию и нажимает Debug. `--проверить будет использоваться
  по умолчанию для узла.js 7+. Чтобы отключить снимите флажок ' js.отладчик.узел.использовать.проверить в
  реестр IDE.

#### [chrome-remote-interface](https://github.com/cyrus-and/chrome-remote-interface)

* Библиотека для упрощения подключения к конечным точкам протокола инспектора.

---

## Опция командной строки

В следующей таблице перечислены влияние различных флагов среды выполнения на отладку:

элементы <table cellpadding="0" cellspacing="0">
  <тр><го>флаг</й><й>смысл</тг></тр>
  <тр>
    <тд>--осмотрите</ТD>
    <ТД>
      <ul>
        <Li>включите инспектор агент</литий>
        < li>прослушивание адреса и порта по умолчанию (127.0.0.1:9229)< / li>
      < / ul>
    </ТД>
  < / tr>
  <тр>
    <тд>--проверить=<я>[сервер:порт]</я></ТD>
    <ТД>
      <ul>
        <Li>включите инспектор агент</литий>
        < li>привязка к адресу или имени хоста < i>хост< / i> (по умолчанию: 127.0.0.1)< / li>
        <литий>на порт <я>порт</я> (по умолчанию: 9229)</литий>
      < / ul>
    </ТД>
  < / tr>
  <тр>
    <тд>--проверить-БРК</ТD>
    <ТД>
      <ul>
        <Li>включите инспектор агент</литий>
        < li>прослушивание адреса и порта по умолчанию (127.0.0.1:9229)< / li>
        < li>перерыв перед запуском пользовательского кода< / li>
      < / ul>
    </ТД>
  < / tr>
  <тр>
    <тд>--проверить-БРК=<я>[сервер:порт]</я></ТD>
    <ТД>
      <ul>
        <Li>включите инспектор агент</литий>
        < li>привязка к адресу или имени хоста < i>хост< / i> (по умолчанию: 127.0.0.1)< / li>
        <литий>на порт <я>порт</я> (по умолчанию: 9229)</литий>
        < li>перерыв перед запуском пользовательского кода< / li>
      < / ul>
    </ТД>
  < / tr>
  <тр>
    <td><code>node inspect < I>скрипт.js</i> < / code>< / td>
    <ТД>
      <ul>
        < li>порождает дочерний процесс для запуска сценария пользователя под флагом --inspect;
            и используйте основной процесс для выполнения отладчика CLI.</ли>
      < / ul>
    </ТД>
  < / tr>
  <тр>
    <td> < code>node inspect --port=xxxx < i>скрипт.js</i> < / code>< / td>
    <ТД>
      <ul>
        < li>порождает дочерний процесс для запуска сценария пользователя под флагом --inspect;
            и используйте основной процесс для выполнения отладчика CLI.</ли>
        <литий>на порт <я>порт</я> (по умолчанию: 9229)</литий>
      < / ul>
    </ТД>
  < / tr>
</таблица>

---

## Включение сценариев удаленной отладки

Не рекомендуется, чтобы отладчик прослушивал общедоступный IP-адрес. Если
вам нужно разрешить удаленную отладку соединений мы рекомендуем использовать ssh
вместо этого туннели. Мы приводим следующий пример только в иллюстративных целях.
Обратите внимание на риск безопасности, связанный с удаленным доступом к привилегированному
обслуживание перед продолжением.

Допустим, вы запускаете Node на удаленной машине, remote.example.com, что ты
хотите иметь возможность отладки. На этой машине следует запустить процесс узла
при этом инспектор слушает только localhost (по умолчанию).

```бить
$ node --inspect сервер.js
``

Теперь на локальном компьютере, с которого требуется запустить клиент отладки
подключения, можно настроить SSH туннель:

```бить
$ ssh-L 9221: localhost: 9229 user@remote.example.com
``

Это запускает сеанс туннеля ssh, где соединение с портом 9221 на вашем локальном
машина будет передана к порту 9229 дальше remote.example.com. Теперь вы можете прикрепить
отладчик, такой как Chrome DevTools или Visual Studio Code to localhost: 9221,
который должен быть в состоянии отлаживать, как будто узел.приложение js работало локально.

---

## Устаревший Отладчик

** Устаревший отладчик устарел с узла 7.7.0. Пожалуйста, используйте-проверьте
а вместо него инспектор.**

При запуске с переключателями** --debug **или** --debug-brk * * в версии 7 и
ранее узел.js слушает команды отладки, определенные прекращенным
Протокол отладки V8 на TCP-порту, по умолчанию '5858'. Любой клиент отладчика
что говорит этот протокол может соединиться с и отлаживаться идущим процессом; а
пара популярных из них перечислены ниже.

Протокол отладки V8 больше не поддерживается и не документируется.

#### [Встроенный отладчик](https://nodejs.org/dist/latest-v6.x/docs/api/debugger.html)

Запустите ' имя_скрипта отладки узла.js ' для запуска скрипта под Node's builtin
отладчик командной строки. Сценарий запускается в другом процессе узла, запущенном с
опция '--debug-brk`, и начальный процесс узла запускает ' _debugger.js`
сценарий и подключается к вашей цели.

#### [Node-inspector](https://github.com/node-inspector/node-inspector)

Отладка узла.js app с Chrome DevTools с помощью промежуточного процесса
который преобразует протокол инспектора, используемый в Chromium, в отладчик V8
протокол, используемый в узле.js.

<!-- refs -->

[Протокол инспектора]: https://chromedevtools.github.io/debugger-protocol-viewer/v8/
[UUID]: https://tools.ietf.org/html/rfc4122